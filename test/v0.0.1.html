<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content=-type" content"text/html;charset=utf-8">
	<title></title>
</head>
<body>
	<button onclick="test1();">测试1</button>
	<button onclick="test2();">测试2</button>
	<button onclick="test3();">测试3</button>
	<script type="text/javascript" src="../src/iPromise.js"></script>
	<script type="text/javascript">
	var test1 = function(){
		var promise = new iPromise(function(resolve, reject){
			// test1: 测试延迟执行
			resolve('hello1');	
		});
		promise
			.then(function(data){
				alert(data);
				// test2: 测试返回值为Promise实例
				var p2 = new iPromise();
				setTimeout(function(){
					p2.resolve('hello2');	
				}, 2000);
				return p2;
			})
			.then(function(data){
				alert(data);
				// test3: 测试返回值为thenable实例
				var thenable = {
					then: function(resolve, reject){
						resolve('hello3');
					}	
				};
				return thenable;
			})
			.then(function(data){
				alert(data);
				// test4: 测试返回值为非Promise或thenable实例
			})
			.then(function(data){
				alert(data);
			});
	};
	var test2 = function(){
		var promise = new iPromise();	
		promise
			.then(null)
			.then(function(data){
				alert(data);
				throw new Error('my error!');
			})
			.then(function(data){
				alert('ok');	
			})
			.then(function(data){
				alert(data);	
			});
		promise.resolve('hello');
	};
	var test3 = function(){
		var promise = new iPromise();	
		promise.then(function(data){
			alert(data);
			return new iPromise(function(resolve){
				resolve('hello2');
			});
		}).then(function(data){
			alert(data);
		});
		promise.then(function(data){
			alert(data);
			return new iPromise(function(resolve){
				resolve('hello3');
			});
		}).then(function(data){
			alert(data);
		});
		promise.resolve('hello1');
	};
	</script>
</body>
</html>